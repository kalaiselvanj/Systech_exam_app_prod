<!DOCTYPE html>
<html>
  <head>
    <title>Camera and Microphone Check</title>
  </head>
  <body>
    <h1>Camera Check:</h1>
    <video id="camera-preview" autoplay></video>

    <h1>Microphone Check:</h1>
    <button id="start-microphone-check">Start Microphone Check</button>
    <button id="stop-microphone-check">Stop Microphone Check</button>
  </body>
  <script>
    let cameraStream;
    let microphoneStream;
    let microphoneRecorder;
    
    // Camera check
    navigator.mediaDevices
      .getUserMedia({ video: true })
      .then((stream) => {
        const videoElement = document.getElementById('camera-preview');
        videoElement.srcObject = stream;
        cameraStream = stream;
        console.log('Camera check successful');
      })
      .catch((error) => {
        console.error('Error accessing camera:', error);
      });
    
    // Microphone check
    const startMicrophoneCheckButton = document.getElementById('start-microphone-check');
    const stopMicrophoneCheckButton = document.getElementById('stop-microphone-check');
    
    startMicrophoneCheckButton.addEventListener('click', startMicrophoneCheck);
    stopMicrophoneCheckButton.addEventListener('click', stopMicrophoneCheck);
    
    function startMicrophoneCheck() {
      navigator.mediaDevices
        .getUserMedia({ audio: true })
        .then((stream) => {
          const audioContext = new AudioContext();
          const source = audioContext.createMediaStreamSource(stream);
          const analyser = audioContext.createAnalyser();
          source.connect(analyser);
          microphoneStream = stream;
          microphoneRecorder = analyser;
    
          console.log('Microphone check successful');
        })
        .catch((error) => {
          console.error('Error accessing microphone:', error);
        });
    }
    
    function stopMicrophoneCheck() {
      if (microphoneStream) {
        microphoneStream.getTracks().forEach((track) => track.stop());
        microphoneStream = null;
        microphoneRecorder = null;
    
        console.log('Microphone check stopped');
      }
    }
    

  </script>
</html>
